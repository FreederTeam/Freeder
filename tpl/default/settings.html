{include="_begin"}
<div id="settings_preferences">
	{* Script preferences *}
	<form method="post" action="#">
		<fieldset>
			<legend>Synchronization</legend>
			<p>
				<input type="radio" name="synchronization_type" id="synchronization_type_ajax" value="ajax" {if="$config->synchronization_type == 'ajax'"} checked="checked"{/if}/><label for="synchronization_type_ajax"> Ajax</label><br/>
				Update the feeds in the background at each page call.
			</p>
			<p>
				<input type="radio" name="synchronization_type" id="synchronization_type_webcron" value="webcron" {if="$config->synchronization_type == 'webcron'"} checked="checked"{/if}/><label for="synchronization_type_webcron"> Webcron</label><br/>
				Use a webcron task to update the feeds regularly. Then, you can register the <code>refresh.php</code> script address at an external webcron service, like e.g. <a href="http://www.easycron.com/">easyCron</a>.
			</p>
			<p>
				<input type="radio" name="synchronization_type" id="synchronization_type_cron" value="cron" {if="$config->synchronization_type == 'cron'"} checked="checked"{/if}/><label for="synchronization_type_cron"> Cron</label><br/>
				Use a crontask to update the feeds regularly.
			</p>
		</fieldset>

		<fieldset>
			<legend>Template</legend>
			<p>
				<label for="template">Template: </label>
				<select name="template" id="template">
					{loop="$templates"}
						<option value="{$value['path']}" {if="$value['current']"}selected="selected"{/if}>{$value['name']}</option>
					{/loop}
				</select>
			</p>
			<p>
				Display entries: <br/>
				<input type="radio" name="display_entries" id="display_entries_full" value="content" {if="$config->display_entries == 'content'"}checked="checked"{/if}/><label for="display_entries_full">Full entry</label><br/>
				<input type="radio" name="display_entries" id="display_entries_desc" value="description" {if="$config->display_entries == 'description'"}checked="checked"{/if}/><label for="display_entries_desc">Only the description</label><br/>
				<input type="radio" name="display_entries" id="display_entries_titles" value="title" {if="$config->display_entries == 'title'"}checked="checked"{/if}/><label for="display_entries_titles">Only titles</label>
			</p>
		</fieldset>

		<fieldset>
			<legend>User</legend>
			{* TODO *}
		</fieldset>

		<fieldset>
			<legend>Entries</legend>

			<p>Tag entries from the tags in the feeds?
				<input type="radio" name="use_tags_from_feeds" id="use_tags_from_feeds_yes" value="1" {if="$config->use_tags_from_feeds != 0"}checked="checked"{/if}/><label for=use_tags_from_feeds_yes">Yes</label>
				<input type="radio" name="use_tags_from_feeds" id="use_tags_from_feeds_no" value="0" {if="$config->use_tags_from_feeds == 0"}checked="checked"{/if}/><label for=use_tags_from_feeds_no">No</label>
			</p>

			<p>
				<label for="entries_to_keep">Number of entries to keep per feed (0 to keep all entries):</label>
				<input type="number" name="entries_to_keep" id="entries_to_keep" value="{$config->entries_to_keep}"/>
			</p>

			<p>
				<label for="entries_per_page">Entries per page:</label>
				<input type="number" name="entries_per_page" id="entries_per_page" value="{$config->entries_per_page}"/>
			</p>
		</fieldset>

		<fieldset>
			<legend>Misc</legend>

			<p><label for="timezone">Timezone: </label><input type="text" name="timezone" id="timezone" value="{$config->timezone}"/></p>
			<p>Anonymous access ?
				<input type="radio" name="anonymous_access" id="anonymous_access_yes" value="1" {if="$config->anonymous_access != 0"}checked="checked"{/if}/><label for="anonymous_access_yes">Yes</label>
				<input type="radio" name="anonymous_access" id="anonymous_access_no" value="0" {if="$config->anonymous_access == 0"}checked="checked"{/if}/><label for="anonymous_access_no">No</label>
			</p>
			<p>Enable URL rewriting ?
				{if="get_url_rewriting() == 1"}
					<input type="radio" name="use_rewriting" id="use_rewriting_yes" value="1" {if="$config->use_rewriting != 0"}checked="checked"{/if}/><label for="use_rewriting_yes">Yes</label>
					<input type="radio" name="use_rewriting" id="use_rewriting_no" value="0" {if="$config->use_rewriting == 0"}checked="checked"{/if}/><label for="use_rewriting_no">No</label>
				{else}
					<span class="error"><code>mod_rewrite</code> does not seem to be enabled on your system.</span>
				{/if}
			</p>
		</fieldset>

		<p><input type="submit" value="Save"/></p>
	</form>
</div>

<div id="settings_feeds">
	{* Feeds management *}
	<h2>Add a feed</h2>
	<form method="post" action="#">
		<p><input type="text" name="feed_url" id="feed_url" placeholder="Feed URL"/></p>
		<p>
			<label for="feed_post">POST data to send to have access to the feed (JSON formatted)</label><br/>
			<textarea name="feed_post" id="feed_post"></textarea>
		</p>
		<p><input type="submit" value="Add feed"/></p>
	</form>
	<h2>List of available feeds</h2>
	{if="count($feeds) > 0"}
		<table>
			{loop="$feeds"}
				<tr>
					<td>{$value['title']}</td>
					<td><a href="{$value['url']}">{$value['url']}</a></td>
					<td>Edit</td>
					<td><a href="settings.php?delete_feed={$value['id']}">Delete</a></td>
					<td><a href="settings.php?refresh_feed={$value['id']}">Refresh</a></td>
				</tr>
			{/loop}
		</table>
	{else}
		<p>You did not add any feeds yet.</p>
	{/if}
</div>

<div id="settings_import_export">
	{* Import / Export panel *}
	<h2>Import an OPML file</h2>
	<form method="post" action="#" enctype="multipart/form-data">
		<input type="hidden" name="MAX_FILE_SIZE" value="1048576" />
		<p><label for="import">OPML file: </label><input type="file" name="import" id="import"/></p>
		<p>
			<input type="submit" value="Import"/>
		</p>
	</form>
	<h2>Export as OPML</h2>
	<form method="post" action="#">
		<p>
			<label for="export">Export selected feeds (ctrl+click to select multiple):</label><br/>
			<select name="export[]" id="export" multiple>
				{loop="$feeds"}
					<option value="{$value['id']}">{$value['title']}</option>
				{/loop}
			</select>
		</p>
		<p><input type="submit" value="Export"/></p>
	</form>
</div>
{include="_end"}
